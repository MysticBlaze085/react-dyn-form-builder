<table class="w-full text-left table-auto min-w-max">
  <thead>
    <tr>
      @if (isSelectable) {
      <th class="border-b border-blue-gray-100 bg-blue-gray-50 p-1 min-h-[48.5px] max-w-[10px]">
        <!-- <pre>{{this.tdss.get('selectedRows').length === this.tdss.get('dataSource').length}}</pre> -->
        <adk-checkbox [field]="field" (change)="toggleRowSelection()"></adk-checkbox>
      </th>
      } @for(header of this.tdss.get('headers'); track $index) {
      <th [ngClass]="isSelectable ? 'p-1' : 'p-4'"
        class="border-b border-blue-gray-100 bg-blue-gray-50 p-3 cursor-pointer min-h-[48.5px]">
        <tw-typography [variant]="'small'" [color]="'blue-gray'"
          [classStyle]="'flex items-center justify-between gap-2 font-normal leading-none opacity-70'">
          {{ header ?? ' ' }}
          <div class="flex flex-row gap-2">
            @if(index !== this.tdss.get('headers').length -1 && isSortable) {
            <tw-sortable-icon (click)="sortRows(header, groupData)"></tw-sortable-icon>
            } @if(this.tdss.get('sortDataSource').key === header && isSortable) {
            <span>{{ this.tdss.get('sortDataSource').direction === 'ascending' ? 'ðŸ”¼' : 'ðŸ”½' }}</span>
            }
          </div>
        </tw-typography>
      </th>
      } @if(actionButton) {
      <th class="border-b border-blue-gray-100 bg-blue-gray-50 p-3">
        <tw-typography [variant]="'small'" [color]="'blue-gray'"
          [classStyle]="'flex items-center justify-between gap-2 font-normal leading-none opacity-70'">
          {{ actionColName ?? '' }}
        </tw-typography>
      </th>
      }
    </tr>
  </thead>
  <tbody>
    @for(groupKey of objectKeysGroupData(groupData); track $index) { @if(groupBy) {
    <tr>
      <td [colSpan]="colSpanNum" class="p-0">{{ groupKey }}</td>
    </tr>
    } @else { @for(rowData of groupData[groupKey]; track $index) {
    <tr>
      @if (isSelectable) {
      <td [ngClass]="isSelectable ? 'p-1' : 'p-4'" class="border-b border-blue-gray-50 max-h-[38px] max-w-[15px]">
        <adk-checkbox [field]="field" (change)="onRowClick(rowData)" className='w-4 h-4'></adk-checkbox>
      </td>
      }
      @for(key of headers; track $index) {
      <td [ngClass]="isSelectable ? 'p-1' : 'p-4'"
        class="border-b border-blue-gray-50 min-h-[48.5px] min-w-[60px] max-w-[60px]">
        <tw-typography [variant]="'small'" [color]="'blue-gray'" class="font-normal ml-2">
          {{ rowData[key.toLowerCase()] }}
        </tw-typography>
      </td>
      <!-- @if (actionButton) {
                    <td class="border-b border-blue-gray-50 p-2 max-h-[40px] min-w-[60px] max-w-[60px]">
                        <ng-container *ngTemplateOutlet="actionButton; context: { $implicit: rowData }"></ng-container>
                    </td>
                    } -->
      }
    </tr>
    } } }
  </tbody>
</table>